(function($){"use strict";const Countdown=function($scope,$){var countDownWrap=$scope.find('.tmpcoder-countdown-wrap'),countDownInterval=null,dataInterval=countDownWrap.data('interval'),dataShowAgain=countDownWrap.data('show-again'),endTime=null,originalDurationMs=null,isEvergreen=!1,widgetID=null,evergreenSettings=null;console.log(countDownWrap);dataInterval=parseFloat(dataInterval)||0;if('evergreen'===countDownWrap.data('type')){isEvergreen=!0;originalDurationMs=dataInterval*1000}else{var dueDateTimestamp=dataInterval*1000;var nowTimestamp=(new Date()).getTime();originalDurationMs=Math.max(dueDateTimestamp-nowTimestamp,0)}
if(isEvergreen){var evergreenDate=new Date();widgetID=$scope.attr('data-id');evergreenSettings=JSON.parse(localStorage.getItem('TmpcoderCountDownSettings'))||{};var storedEndTime=null;if(evergreenSettings.hasOwnProperty(widgetID)){if(Object.keys(evergreenSettings).length===0||dataInterval!==evergreenSettings[widgetID].interval){endTime=evergreenDate.getTime()+(dataInterval*1000)}else{storedEndTime=evergreenSettings[widgetID].endTime;if(storedEndTime&&typeof storedEndTime==='number'&&storedEndTime>0){endTime=storedEndTime}else{endTime=evergreenDate.getTime()+(dataInterval*1000)}}}else{endTime=evergreenDate.getTime()+(dataInterval*1000)}
var nowTs=evergreenDate.getTime();if(endTime+parseFloat(dataShowAgain||0)<nowTs){endTime=nowTs+(dataInterval*1000)}
evergreenSettings[widgetID]={interval:dataInterval,endTime:endTime};localStorage.setItem('TmpcoderCountDownSettings',JSON.stringify(evergreenSettings))}else{endTime=dataInterval*1000}
if(isNaN(endTime)||endTime<=0||typeof endTime!=='number'){var fallbackNow=(new Date()).getTime();endTime=fallbackNow+(60*60*1000);originalDurationMs=60*60*1000}
if(!originalDurationMs||isNaN(originalDurationMs)||originalDurationMs<=0){if(isEvergreen&&dataInterval){originalDurationMs=dataInterval*1000}else{originalDurationMs=60*60*1000}}
if(!editorCheck()){}
initCountDown();countDownInterval=setInterval(initCountDown,1000);function initCountDown(){var endTimeTs=(typeof endTime==='number')?endTime:(endTime instanceof Date?endTime.getTime():parseFloat(endTime)||0);var nowTs=(new Date()).getTime();var timeLeft=endTimeTs-nowTs;if(isNaN(timeLeft)){timeLeft=0}
var dataActions=countDownWrap.data('actions');var shouldRestart=dataActions&&Object.prototype.hasOwnProperty.call(dataActions,'restart-timer');if(timeLeft<0&&shouldRestart&&!editorCheck()){clearInterval(countDownInterval);restartTimer();return}
var numbers={days:Math.floor(timeLeft/(1000*60*60*24)),hours:Math.floor((timeLeft/(1000*60*60))%24),minutes:Math.floor((timeLeft/1000/60)%60),seconds:Math.floor((timeLeft/1000)%60)};if(isNaN(numbers.days)||isNaN(numbers.hours)||isNaN(numbers.minutes)||isNaN(numbers.seconds)){numbers={days:0,hours:0,minutes:0,seconds:0}}
if(numbers.days<0||numbers.hours<0||numbers.minutes<0||numbers.seconds<0){numbers={days:0,hours:0,minutes:0,seconds:0}}
$scope.find('.tmpcoder-countdown-number').each(function(){var itemType=$(this).attr('data-item');var number=numbers[itemType];if(isNaN(number)){number=0}
if(1===number.toString().length){number='0'+number}
$(this).text(number);var labels=$(this).next();if(labels.length){if(!$(this).hasClass('tmpcoder-countdown-seconds')){var labelText=labels.data('text');if(labelText&&typeof labelText==='object'){if('01'==number){labels.text(labelText.singular)}else{labels.text(labelText.plural)}}}}});if(timeLeft<0&&!shouldRestart){clearInterval(countDownInterval);expiredActions()}}
function restartTimer(){$scope.find('.tmpcoder-countdown-message').remove();countDownWrap.show();var nowTs=(new Date()).getTime();var restartDurationMs;if(originalDurationMs&&originalDurationMs>0){restartDurationMs=originalDurationMs}else if(isEvergreen&&dataInterval){restartDurationMs=dataInterval*1000}else{restartDurationMs=60*60*1000}
endTime=nowTs+restartDurationMs;if(isEvergreen&&widgetID){if(!evergreenSettings){evergreenSettings=JSON.parse(localStorage.getItem('TmpcoderCountDownSettings'))||{}}
evergreenSettings[widgetID]={interval:dataInterval,endTime:endTime};localStorage.setItem('TmpcoderCountDownSettings',JSON.stringify(evergreenSettings))}
countDownInterval=setInterval(initCountDown,1000);initCountDown()}
function expiredActions(){var dataActions=countDownWrap.data('actions');if(!editorCheck()){if(dataActions&&Object.prototype.hasOwnProperty.call(dataActions,'restart-timer')){restartTimer();return}
if(dataActions.hasOwnProperty('hide-timer')){countDownWrap.hide()}
if(dataActions.hasOwnProperty('hide-element')){$(dataActions['hide-element']).hide()}
if(dataActions.hasOwnProperty('message')){if(!$scope.find('.tmpcoder-countdown-message').length){console.log('message1');var sanitizedMessage=sanitizeHTMLContent(dataActions.message);countDownWrap.after('<div class="tmpcoder-countdown-message">'+sanitizedMessage+'</div>')}}
if(dataActions.hasOwnProperty('redirect')){window.location.href=TmpcodersanitizeURL(dataActions.redirect)}
if(dataActions.hasOwnProperty('load-template')){countDownWrap.next('.elementor').show()}}}}
const sanitizeHTMLContent=function(html){var tempDiv=document.createElement('div');tempDiv.innerHTML=html;var scripts=tempDiv.getElementsByTagName('script');while(scripts.length>0){scripts[0].parentNode.removeChild(scripts[0])}
var iframes=tempDiv.getElementsByTagName('iframe');while(iframes.length>0){iframes[0].parentNode.removeChild(iframes[0])}
var allElements=tempDiv.getElementsByTagName('*');for(var i=0;i<allElements.length;i++){var attrs=allElements[i].attributes;for(var j=attrs.length-1;j>=0;j--){var attrName=attrs[j].name;if(attrName.substring(0,2)==='on'){allElements[i].removeAttribute(attrName)}
if(attrName==='href'||attrName==='src'){var value=attrs[j].value;if(value.toLowerCase().indexOf('javascript:')===0){allElements[i].removeAttribute(attrName)}}}}
return tempDiv.innerHTML}
$(window).on('elementor/frontend/init',function(){elementorFrontend.hooks.addAction('frontend/element_ready/tmpcoder-countdown.default',Countdown)})})(jQuery)